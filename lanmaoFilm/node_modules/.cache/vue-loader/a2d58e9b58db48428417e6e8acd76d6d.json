{"remainingRequest":"D:\\Vue\\vuepro\\miaomiao\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Vue\\vuepro\\miaomiao\\src\\views\\Mine\\center.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Vue\\vuepro\\miaomiao\\src\\views\\Mine\\center.vue","mtime":1584685475031},{"path":"D:\\Vue\\vuepro\\miaomiao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Vue\\vuepro\\miaomiao\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Vue\\vuepro\\miaomiao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Vue\\vuepro\\miaomiao\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOw0KaW1wb3J0IHsgbWVzc2FnZUJveCB9IGZyb20gJ0AvY29tcG9uZW50cy9KUyc7DQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZSA6ICdjZW50ZXInLA0KICAgIG1ldGhvZHMgOiB7DQogICAgICAgIGhhbmRsZVRvTG9nb3V0KCl7DQogICAgICAgICAgICB0aGlzLmF4aW9zLmdldCgnL2FwaTIvdXNlcnMvbG9nb3V0JykudGhlbigocmVzKT0+ew0KICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IHJlcy5kYXRhLnN0YXR1czsNCiAgICAgICAgICAgICAgICBpZihzdGF0dXMgPT09IDApew0KICAgICAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbmFtZScpOw0KICAgICAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnaXNBZG1pbicpOw0KICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXIvVVNFUl9OQU1FJywgeyBuYW1lIDogJycsIGlzQWRtaW4gOiBmYWxzZSAsIHVzZXJIZWFkIDogJyd9KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9taW5lL2xvZ2luJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpPT57DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlVG9VcGxvYWQoZXYpew0KICAgICAgICAgICAgdmFyIGZpbGUgPSBldi50YXJnZXQuZmlsZXNbMF07DQogICAgICAgICAgICB2YXIgcGFyYW0gPSBuZXcgRm9ybURhdGEoKTsNCiAgICAgICAgICAgIHBhcmFtLmFwcGVuZCgnZmlsZScsIGZpbGUgLCBmaWxlLm5hbWUpOw0KICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHsNCiAgICAgICAgICAgICAgICBoZWFkZXJzIDogew0KICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJyA6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuYXhpb3MucG9zdCgnL2FwaTIvdXNlcnMvdXBsb2FkVXNlckhlYWQnLCBwYXJhbSAsIGNvbmZpZykudGhlbigocmVzKT0+ew0KICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSByZXMuZGF0YS5zdGF0dXM7DQogICAgICAgICAgICAgICAgdmFyIFRoaXMgPSB0aGlzOw0KICAgICAgICAgICAgICAgIGlmKCBzdGF0dXMgPT09IDApew0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQm94KHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlIDogJ+S/oeaBrycsDQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50IDogJ+S4iuS8oOWktOWDj+aIkOWKnycsDQogICAgICAgICAgICAgICAgICAgICAgICBvayA6ICfnoa7lrponLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGFubGRlT2soKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXIvVVNFUl9OQU1FJyx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgOiBUaGlzLiRzdG9yZS5zdGF0ZS51c2VyLm5hbWUgLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBZG1pbiA6IFRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuaXNBZG1pbiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckhlYWQgOiByZXMuZGF0YS5kYXRhLnVzZXJIZWFkICsgJz8nICsgTWF0aC5yYW5kb20oKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfSkNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlew0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gICAgDQogICAgfSwNCiAgICBiZWZvcmVSb3V0ZUVudGVyICh0bywgZnJvbSwgbmV4dCkgew0KICAgICAgICAgICAgLy8gdm0gPT4gew0KICAgICAgICAgICAgLy8gICAgIHZtLiRzdG9yZS5jb21taXQoJ3VzZXIvVVNFUl9OQU1FJyx7IA0KICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIG5hbWUgOiAnYScgLCANCiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBpc0FkbWluIDogdHVyZSwNCiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB1c2VySGVhZCA6ICcnDQogICAgICAgICAgICAvLyAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIC8vICAgICB9DQoNCiAgICAgICAgICAgIGF4aW9zLmdldCgnL2FwaTIvdXNlcnMvZ2V0VXNlcicpLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gcmVzLmRhdGEuc3RhdHVzOw0KICAgICAgICAgICAgICAgIGlmKHN0YXR1cyA9PT0gMCl7ICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBuZXh0KA0KICAgICAgICAgICAgICAgICAgICAgICAgdm0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCduYW1lJyxyZXMuZGF0YS5kYXRhLnVzZXJuYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaXNBZG1pbicscmVzLmRhdGEuZGF0YS5pc0FkbWluKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS4kc3RvcmUuY29tbWl0KCd1c2VyL1VTRVJfTkFNRScseyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA6IHJlcy5kYXRhLmRhdGEudXNlcm5hbWUgLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBZG1pbiA6IHJlcy5kYXRhLmRhdGEuaXNBZG1pbiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckhlYWQgOiByZXMuZGF0YS5kYXRhLnVzZXJIZWFkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgIG5leHQoJy9taW5lL2xvZ2luJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkuY2F0Y2goKGVycik9PnsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyPicsZXJyKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KDQogICANCg0KfQ0K"},{"version":3,"sources":["center.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA","file":"center.vue","sourceRoot":"src/views/Mine","sourcesContent":["<template>\r\n    <div>\r\n        <div>个人中心：</div>\r\n        <div class=\"userdiv\">当前用户：{{ $store.state.user.name }} <div class=\"logout\" @touchstart=\"handleToLogout\">退出</div></div>\r\n       <!-- <div v-if=\"$store.state.user.isAdmin\">用户身份：管理员 <a href=\"/admin\" target=\"_blank\">进入管理后台</a></div>\r\n        <div v-else>用户身份：普通会员</div> -->\r\n        <!-- <div>\r\n            <input type=\"file\" name=\"file\" value=\"上传头像\">\r\n            <img class=\"userHead\" :src=\"$store.state.user.userHead\" alt=\"\">\r\n        </div> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { messageBox } from '@/components/JS';\r\nexport default {\r\n    name : 'center',\r\n    methods : {\r\n        handleToLogout(){\r\n            this.axios.get('/api2/users/logout').then((res)=>{\r\n            console.log(res);\r\n                 var status = res.data.status;\r\n                if(status === 0){\r\n                    // localStorage.removeItem('name');\r\n                    // localStorage.removeItem('isAdmin');\r\n                    // this.$store.commit('user/USER_NAME', { name : '', isAdmin : false , userHead : ''});\r\n                    this.$router.push('/mine/login');\r\n                    \r\n                }\r\n            }).catch((err)=>{\r\n                console.log(err)\r\n            })\r\n        },\r\n        handleToUpload(ev){\r\n            var file = ev.target.files[0];\r\n            var param = new FormData();\r\n            param.append('file', file , file.name);\r\n            var config = {\r\n                headers : {\r\n                    'Content-Type' : 'multipart/form-data'\r\n                }\r\n            }\r\n            this.axios.post('/api2/users/uploadUserHead', param , config).then((res)=>{\r\n                var status = res.data.status;\r\n                var This = this;\r\n                if( status === 0){\r\n                    messageBox({\r\n                        title : '信息',\r\n                        content : '上传头像成功',\r\n                        ok : '确定',\r\n                        hanldeOk(){\r\n                            this.$store.commit('user/USER_NAME',{\r\n                                name : This.$store.state.user.name , \r\n                                isAdmin : This.$store.state.user.isAdmin,\r\n                                userHead : res.data.data.userHead + '?' + Math.random()\r\n                            });\r\n\r\n                        }\r\n\r\n                    })\r\n\r\n                }\r\n                else{\r\n\r\n                }\r\n            });\r\n        }    \r\n    },\r\n    beforeRouteEnter (to, from, next) {\r\n            // vm => {\r\n            //     vm.$store.commit('user/USER_NAME',{ \r\n            //                 name : 'a' , \r\n            //                 isAdmin : ture,\r\n            //                 userHead : ''\r\n            //             });\r\n            //     }\r\n\r\n            axios.get('/api2/users/getUser').then((res)=>{\r\n                var status = res.data.status;\r\n                if(status === 0){                   \r\n                    next(\r\n                        vm => {\r\n                            localStorage.setItem('name',res.data.data.username);\r\n                            localStorage.setItem('isAdmin',res.data.data.isAdmin);\r\n                            vm.$store.commit('user/USER_NAME',{ \r\n                                name : res.data.data.username , \r\n                                isAdmin : res.data.data.isAdmin,\r\n                                userHead : res.data.data.userHead\r\n                            });\r\n                        }\r\n                    );\r\n                }\r\n                else{\r\n                    next('/mine/login');\r\n                }\r\n            }).catch((err)=>{\r\n                console.log('err>',err);\r\n            \r\n            })\r\n        }\r\n\r\n   \r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.userHead{ width:100px; height: 100px; border-radius: 50%; overflow: hidden;}\r\n.userdiv{display: flex;}\r\n.logout{ margin-left: 20px; color: blue}\r\n\r\n</style>\r\n"]}]}